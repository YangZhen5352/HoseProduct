define("pages/query",function(t){var i=t("vue"),e=t("alertShow"),s=t("postData"),o=t("fastclick"),n=window.localStorage;i.use(t("toast")),i.use(t("loading"));new i({el:"#query",data:{community:"",communityId:"",building:"",door:"",area:"",purpose:"",nature:"",buildingList:[],doorList:[],purposeList:[{value:"01",text:"普通商品住宅"},{value:"21",text:"住宅"},{value:"02",text:"商住"},{value:"03",text:"别墅"},{value:"22",text:"酒店式公寓"},{value:"23",text:"商务公寓"},{value:"24",text:"服务式公寓"},{value:"25",text:"公寓(非住宅)"},{value:"26",text:"公寓"},{value:"05",text:"商业"},{value:"04",text:"写字楼"},{value:"06",text:"其他"}],natureList:[{value:"6",text:"商品房"},{value:"3",text:"经适房"},{value:"10",text:"按经适房管理"},{value:"11",text:"按商品房管理"},{value:"2",text:"房改房"},{value:"5",text:"成本价房"},{value:"1",text:"回迁房"},{value:"4",text:"央产房"},{value:"7",text:"酒店式公寓"},{value:"8",text:"其他"}],keyWords:"",isShowComList:0,communityList:{},isShowHistory:!1,histories:"",quotaFirst:0,quotaSecond:0,valuation:0,reqFlowNo:"",currentView:"inputInfos"},components:{"del-btn":t("del-btn")},filters:{delComma:{write:function(t){return t&&t.replace(/,/g,"")}}},computed:{historyList:function(){return this.histories.split(",")}},methods:{replaceLtr:function(){"25"==this.purpose&&(document.querySelector('#replaceLtr option[value="25"]').innerHTML="(公寓(非住宅")},setCommunity:function(t,i){(""===this.community||this.community!==i)&&(this.building=this.door=this.area="",this.community=i,this.communityId=t,this.getBuilding()),this.go("inputInfos")},getHotSearch:function(){this.showLoading(),s({url:"/wechat/doquery/",data:{queryType:3,M_TOKEN:M_TOKEN,buildId:this.building,buildName:this.buildingList[this.building],reqFlowNo:this.reqFlowNo},success:function(t){2e6===t.retcode?this.doorList=t.houseList:e(t.msg||"服务异常"),this.closeLoading()}.bind(this),error:function(){this.closeLoading()}.bind(this),complete:function(){this.closeLoading()}.bind(this)})},getDoor:function(){return this.building&&this.buildingList?(this.showLoading(),void s({url:"/wechat/doquery/",data:{queryType:3,M_TOKEN:M_TOKEN,buildId:this.building,buildName:this.buildingList[this.building],reqFlowNo:this.reqFlowNo},success:function(t){2e6===t.retcode?(this.doorList=t.houseList,this.door=""):e(t.msg||"服务异常"),this.closeLoading()}.bind(this),error:function(){this.closeLoading()}.bind(this),complete:function(){this.closeLoading()}.bind(this)})):void this.openToast("请先选择抵押物所在楼栋")},getBuilding:function(){return this.community?(this.showLoading(),void s({url:"/wechat/doquery/",data:{queryType:2,M_TOKEN:M_TOKEN,constructionId:this.communityId,constructionName:this.community,reqFlowNo:this.reqFlowNo},success:function(t){2e6===t.retcode?this.buildingList=t.buildingList:e(t.msg||"服务异常"),this.closeLoading()}.bind(this),error:function(){this.closeLoading()}.bind(this),complete:function(){this.closeLoading()}.bind(this)})):(this.openToast("请先选择抵押物所在的小区"),!1)},search:function(t){var i=document.getElementById("searchBtn");return this.keyWords=t,!this.keyWords.trim()||i.clicked?!1:(i.clicked=!0,this.showLoading(),void s({elm:i,url:"/wechat/doquery/",data:{queryType:1,keyWords:this.keyWords,M_TOKEN:M_TOKEN},success:function(t){2e6===t.retcode?(this.isShowComList=1,this.communityList=t.constructionList,this.reqFlowNo=t.reqFlowNo,this.addHistory(this.keyWords)):this.isShowComList=2,this.closeLoading()}.bind(this),error:function(){this.closeLoading()}.bind(this),complete:function(){this.closeLoading()}.bind(this)}))},submit:function(){return this.validate()?(this.showLoading(),void $.ajax({url:"/wechat/doquery/",type:"post",data:{queryType:4,reqFlowNo:this.reqFlowNo,houseId:this.door,houseName:this.doorList[this.door],areaSize:this.area,houseProperty:this.nature,planUse:this.purpose,constructionId:this.communityId,constructionName:this.community,buildId:this.building,buildName:this.buildingList[this.building],keyWords:this.keyWords,M_TOKEN:M_TOKEN},success:function(t){2e6===t.retcode?0!==t.query_result?(this.quotaFirst=t.first_mortgage,this.quotaSecond=t.second_mortgage,this.valuation=t.max_value,this.go("resultPage")):e(t.msg,2,"取消","人工询值",function(){},function(){window.location.href="/wechat/apply/?notTip"}):e(t.msg||"服务异常")}.bind(this),error:function(){this.closeLoading()}.bind(this),complete:function(){this.closeLoading()}.bind(this)})):!1},go:function(t){location.hash="#!/"+t},validate:function(){return this.community&&this.building&&this.door&&this.area&&this.purpose&&this.nature},showHistory:function(){if(n){var t=n.getItem("histories");t&&t.length>0&&(this.histories=t,this.isShowHistory=!0)}},addHistory:function(t){if(n){null===n.getItem("histories")&&n.setItem("histories",[]);var i=n.getItem("histories");i.indexOf(t.trim())<0&&(i.length>0?(this.histories=t+","+i,n.setItem("histories",t+","+i)):(this.histories=t,n.setItem("histories",t)))}},cleanHistory:function(){n&&(n.removeItem("histories"),this.histories="")},onhashchange:function(){var t=location.hash.slice(1);switch(t){case"!/inputInfos":this.currentView="inputInfos";break;case"!/searchCommunity":this.currentView="searchCommunity";break;case"!/resultPage":this.currentView="resultPage";break;default:this.currentView="inputInfos"}}},ready:function(){this.showHistory(),this.onhashchange(),window.onhashchange=function(){this.onhashchange()}.bind(this)}});o(document.body)});